<!DOCTYPE html>

<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
<!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'><![endif]-->
<meta name="viewport" content="width=device-width,initial-scale=1">

<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>2019/12/09-15 weekly review | SingularityKChen</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="2019/12/09-15 weekly review" />
<meta name="author" content="SingularityKChen" />
<meta property="og:locale" content="en" />
<meta name="description" content="the weekly review from 2019/12/09 to 15" />
<meta property="og:description" content="the weekly review from 2019/12/09 to 15" />
<link rel="canonical" href="http://localhost:4000/blog/2019/12/15/2019-12-09-15-weekly-review/" />
<meta property="og:url" content="http://localhost:4000/blog/2019/12/15/2019-12-09-15-weekly-review/" />
<meta property="og:site_name" content="SingularityKChen" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-12-15T00:00:00+08:00" />
<script type="application/ld+json">
{"dateModified":"2019-12-15T00:00:00+08:00","datePublished":"2019-12-15T00:00:00+08:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/2019/12/15/2019-12-09-15-weekly-review/"},"url":"http://localhost:4000/blog/2019/12/15/2019-12-09-15-weekly-review/","author":{"@type":"Person","name":"SingularityKChen"},"description":"the weekly review from 2019/12/09 to 15","headline":"2019/12/09-15 weekly review","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<meta name="keywords" content="WeeklyReview,git,RISC-V,RoCC,Chipyard,SHA3,cache" />





<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="SingularityKChen" />
    <link href='/assets/stylesheets/blog.css' rel="stylesheet" type="text/css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
<script>window.Modernizr || document.write('<script src="/assets/javascripts/modernizr-2.8.3.min.js"><\/script>')</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
    window.jQuery || document.write('<script src="/assets/javascripts/jquery-3.3.1.min.js"><\/script>')
</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
<script>
    window.Pace || document.write('<script src="/assets/javascripts/pace.min.js"><\/script>')
</script>

    
</head>

<body>
    

    <!--[if IE]>
    <p class="site-notice">You are using an outdated browser. Please <a href="http://browsehappy.com/" target="_blank">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true" target="_blank">activate Google Chrome Frame</a> to improve your experience.</p>
<![endif]-->
<noscript>
    <p class="site-notice">This site requires JavaScript. Here are the instructions <a href="http://www.enable-javascript.com/" target="_blank">how to enable JavaScript in your web browser</a>.</p>
</noscript>

    <div class="nav-wrapper overlay-wrapper">
    <div class="nav-form overlay-form">
        <span class="overlay-header menu">Menu</span>
        <a class="btn-close">Close</a>
        <div class="results">
            <ul>
                <li><a href="/blog/categories/">Categories</a></li>
                <li><a href="/blog/tags/">Tags</a></li>
                <li><a href="/">About</a></li>
            </ul>
        </div>
    </div>
</div>

<div class="search-wrapper overlay-wrapper">
    <div class="search-form overlay-form">
        <input type="text" class="overlay-header search-field" placeholder="Search...">
        <a class="btn-close">Close</a>
        <ul class="results"></ul>
    </div>
</div>


    <div id="page" class="hentry">
        <header class="the-header">
    <div class="unit-head">
        <div class="unit-inner unit-head-inner">
            <nav class="nav-global">
                <ul>
                    <li class="logo nav-link">
                        <button class="btn-menu" title="Menu"></button>
                        <a href="/blog/">SingularityKChen's Blog</a>
                        <span style="opacity: 0.6;">/<small><a href="https://github.com/SingularityKChen?tab=repositories">Projects</a></small></span>
                    </li>
                    <li class="nav-link"><a title="Categories" href="/blog/categories/">Categories</a></li>
                    <li class="nav-link"><a title="Tags" href="/blog/tags/">Tags</a></li>
                    <!--[if !IE]> -->
                    <li class="nav-link"><a title="Search" class="btn-search" href="#">Search</a></li>
                    <!-- <![endif]-->
                </ul>
            </nav>
        </div>
    </div>
</header>


        <div class="body animated fadeInDown" role="main">
            <div class="unit-body">
                <div class="unit-inner unit-body-inner">
                    <div class="entry-content">
                        <article class="unit-article layout-post">
    <div class="unit-inner unit-article-inner">
        <div itemscope itemtype="http://schema.org/Article" class="content">
            <header>
                <div class="unit-head">
                    <div class="unit-inner unit-head-inner">
                        <h1 class="entry-title" itemprop="name">2019/12/09-15 weekly review</h1>
                    </div>
                </div>
            </header>
            <div class="bd article-content">
                <div class="entry-content">
                    <div class="meta">
                        <p class="date-publish">
                            Published:
                            <time itemprop="datePublished" class="date-pub "
                                title="2019-12-15T00:00:00+08:00" datetime="2019-12-15T00:00:00+08:00">December 15, 2019 </time>
                            by
                            <a class="author" href="/" rel="author" title="Show Author">
                                <span itemprop="author" itemscope itemtype="http://schema.org/Person">
                                    <span itemprop="name">SingularityKChen</span>
                                </span>
                            </a>
                            
                                <a class="license-icon" rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" title="Show License">
                                    <img alt="Creative Commons Licence" style="border-width:0" src="/assets/images/theme/cc-by-sa.png"  height="16" width="80"/>
                                </a>
                            
                            
                                (Last updated:
                                <time class="date-updated updated" title="2020-02-03T22:02:00+08:00" datetime="2020-02-03T22:02:00+08:00">2020-02-03 14:02:00 +0000</time>)
                            
                        </p>
                        <ul class="list-category list-linear">
                            <li class="list-head">Categories: </li>
                             
     
        <li>
            <a href="/blog/categories/#WeeklyReview" title="WeeklyReview">
            WeeklyReview <span>8</span></a>
        </li>
    



                        </ul>
                        <ul class="list-tag list-linear">
                            <li class="list-head">Tags: </li>
                             
    
        
        <li>
            <a href="/blog/tags/#Chipyard" title="Chipyard">Chipyard <span>1</span></a>
        </li>
    
        
        <li>
            <a href="/blog/tags/#RISC-V" title="RISC-V">RISC-V <span>1</span></a>
        </li>
    
        
        <li>
            <a href="/blog/tags/#RoCC" title="RoCC">RoCC <span>1</span></a>
        </li>
    
        
        <li>
            <a href="/blog/tags/#SHA3" title="SHA3">SHA3 <span>1</span></a>
        </li>
    
        
        <li>
            <a href="/blog/tags/#WeeklyReview" title="WeeklyReview">WeeklyReview <span>8</span></a>
        </li>
    
        
        <li>
            <a href="/blog/tags/#cache" title="cache">cache <span>1</span></a>
        </li>
    
        
        <li>
            <a href="/blog/tags/#git" title="git">git <span>1</span></a>
        </li>
    




                        </ul>
                    </div>
                    <div itemprop="articleBody">
                        <ul class="toc" id="markdown-toc">
  <li><a href="#heading-20191209-15" id="markdown-toc-heading-20191209-15">2019/12/09-15</a>    <ul>
      <li><a href="#heading-git-command" id="markdown-toc-heading-git-command">Git Command</a>        <ul>
          <li><a href="#heading-the-workflow" id="markdown-toc-heading-the-workflow">the workflow</a></li>
          <li><a href="#heading-build-a-git-project" id="markdown-toc-heading-build-a-git-project">Build a git project</a></li>
          <li><a href="#heading-other-git-commands" id="markdown-toc-heading-other-git-commands">Other Git Commands</a></li>
        </ul>
      </li>
      <li><a href="#heading-matrix-sum-accelerator" id="markdown-toc-heading-matrix-sum-accelerator">Matrix Sum Accelerator</a></li>
      <li><a href="#heading-chisel3-syntax" id="markdown-toc-heading-chisel3-syntax">Chisel3 Syntax</a></li>
      <li><a href="#heading-linux-c-syntax" id="markdown-toc-heading-linux-c-syntax">(Linux) C Syntax</a>        <ul>
          <li><a href="#heading-asm-volatile" id="markdown-toc-heading-asm-volatile"><code class="language-plaintext highlighter-rouge">asm volatile</code></a></li>
          <li><a href="#heading-create-a-c-matrix-with-2-d-array" id="markdown-toc-heading-create-a-c-matrix-with-2-d-array">create a C matrix with 2-D Array</a></li>
          <li><a href="#heading-pointer-and-address-access" id="markdown-toc-heading-pointer-and-address-access">Pointer and address access</a></li>
        </ul>
      </li>
      <li><a href="#heading-risc-v-spec" id="markdown-toc-heading-risc-v-spec">RISC-V SPEC</a></li>
      <li><a href="#heading-chipyard" id="markdown-toc-heading-chipyard">Chipyard</a>        <ul>
          <li><a href="#heading-sha3" id="markdown-toc-heading-sha3"><code class="language-plaintext highlighter-rouge">SHA3</code></a></li>
          <li><a href="#heading-hwacha" id="markdown-toc-heading-hwacha"><code class="language-plaintext highlighter-rouge">Hwacha</code></a></li>
        </ul>
      </li>
      <li><a href="#heading-rocc-and-extension-instruction" id="markdown-toc-heading-rocc-and-extension-instruction"><code class="language-plaintext highlighter-rouge">RoCC</code> and extension instruction</a>        <ul>
          <li><a href="#heading-rocc-component" id="markdown-toc-heading-rocc-component"><code class="language-plaintext highlighter-rouge">RoCC</code> component</a></li>
          <li><a href="#heading-extension-instruction-with-rocc" id="markdown-toc-heading-extension-instruction-with-rocc">extension instruction with <code class="language-plaintext highlighter-rouge">RoCC</code></a></li>
          <li><a href="#heading-hellacache" id="markdown-toc-heading-hellacache"><code class="language-plaintext highlighter-rouge">HellaCache</code></a></li>
        </ul>
      </li>
      <li><a href="#heading-chisel-tester2" id="markdown-toc-heading-chisel-tester2">Chisel-Tester2</a></li>
      <li><a href="#heading-hammer" id="markdown-toc-heading-hammer">Hammer</a></li>
      <li><a href="#heading-computer-architecture" id="markdown-toc-heading-computer-architecture">Computer Architecture</a>        <ul>
          <li><a href="#heading-memory-fence-and-memory-barrier" id="markdown-toc-heading-memory-fence-and-memory-barrier">Memory Fence and Memory Barrier</a></li>
          <li><a href="#heading-page-table-walk" id="markdown-toc-heading-page-table-walk">Page Table Walk</a></li>
          <li><a href="#heading-translation-lookaside-buffer" id="markdown-toc-heading-translation-lookaside-buffer">Translation Lookaside Buffer</a></li>
          <li><a href="#heading-cache-hierarchy" id="markdown-toc-heading-cache-hierarchy">Cache Hierarchy</a></li>
          <li><a href="#heading-memory-read-synchronous-and-asynchronous" id="markdown-toc-heading-memory-read-synchronous-and-asynchronous">Memory Read (Synchronous and Asynchronous)</a></li>
        </ul>
      </li>
      <li><a href="#heading-some-trouble" id="markdown-toc-heading-some-trouble">Some Trouble</a>        <ul>
          <li><a href="#heading-psutil" id="markdown-toc-heading-psutil"><code class="language-plaintext highlighter-rouge">psutil</code></a></li>
          <li><a href="#heading-import-classes-into-intellij-idea" id="markdown-toc-heading-import-classes-into-intellij-idea">Import classes into <code class="language-plaintext highlighter-rouge">IntelliJ IDEA</code></a></li>
          <li><a href="#heading-import-reliance-into-sbt-project" id="markdown-toc-heading-import-reliance-into-sbt-project">Import reliance into <code class="language-plaintext highlighter-rouge">sbt</code> project</a></li>
          <li><a href="#heading-can-not-find-the-lvy-local-lib" id="markdown-toc-heading-can-not-find-the-lvy-local-lib">Can not find the lvy local lib</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h1 id="heading-20191209-15">2019/12/09-15</h1>

<p>Last week, I finished the draft version of the matrix sum with Chisel and became half-familiar with it. Also, I tried to write a functional test with <code class="language-plaintext highlighter-rouge">Chisel-tester2</code>. Unfortunately, due to the complex and unstable environment, I can not check all the syntax or run the functional test, but I tried to use the environment in <code class="language-plaintext highlighter-rouge">Jupyter</code> to run a simple test and two small submodules had been proved right. To use Chisel and <code class="language-plaintext highlighter-rouge">Chipyard</code>'s components, I studied one sample project named <a href="#SHA3"><code class="language-plaintext highlighter-rouge">SHA3</code></a>. If I have more time, I'd back here to restudy that.</p>

<p>Fortunately, while I was programming the matrix sum project, I realized the feeling of distinguishing the difference of Scala types and hardware types. I mean, I knew why we can utilize the features of Scala to boost our efficiency of design our circuits and when we should create a hardware register to store our mediate data, why the hardware type <code class="language-plaintext highlighter-rouge">UInt</code> can not be translated to the Scala type <code class="language-plaintext highlighter-rouge">Int</code>. Just because Scala is the hardware generator, it's a software programming language, its types exist when we build the project. But as for hardware types, they only exist when the circuits running. So we can not get an unknown value and translate it to a must-know value.</p>

<p>So this week, I'll try to finish the related C files and run the simulation on FPGA boards. Also, I need to learn some Scala programming skills to enhance my Chisel coding ability.</p>

<hr />

<h2 id="heading-git-command">Git Command</h2>

<p><a href="https://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html">some useful command and the explanation of git</a>.
<img src="https://www.ruanyifeng.com/blogimg/asset/2015/bg2015120901.png" alt="the work flow" /></p>

<h3 id="heading-the-workflow">the workflow</h3>

<ul>
  <li>
    <p>Workspace</p>
  </li>
  <li>
    <p>Index/Stage</p>
  </li>
  <li>
    <p>Repository</p>
  </li>
  <li>
    <p>Remote</p>
  </li>
</ul>

<h3 id="heading-build-a-git-project">Build a git project</h3>

<h4 id="heading-create-one-new-project">Create one new project</h4>

<p><code class="language-plaintext highlighter-rouge">git init [project-name]</code></p>

<h4 id="heading-config">Config</h4>

<p>show current git config: <code class="language-plaintext highlighter-rouge">git config --list</code></p>

<h4 id="heading-addremove-files">add/remove files</h4>

<p>These files will be added or removed to <code class="language-plaintext highlighter-rouge">Index</code>.</p>

<p><code class="language-plaintext highlighter-rouge">git rm/add [file1] [file2]</code></p>

<p><code class="language-plaintext highlighter-rouge">git mv [file-original] [file-renamed]</code></p>

<h4 id="heading-commit-codes-from-index-to-repository">Commit codes from <code class="language-plaintext highlighter-rouge">Index</code> to <code class="language-plaintext highlighter-rouge">Repository</code></h4>

<p>These commands will update all the changes from <code class="language-plaintext highlighter-rouge">Index</code> to <code class="language-plaintext highlighter-rouge">Repository</code>.</p>

<p><code class="language-plaintext highlighter-rouge">git commit -m 'yourmessage'</code></p>

<p><code class="language-plaintext highlighter-rouge">git commit -v</code> to show all the differences.</p>

<h4 id="heading-push-codes-from-repository-to-remote">Push codes from <code class="language-plaintext highlighter-rouge">Repository</code> to <code class="language-plaintext highlighter-rouge">Remote</code></h4>

<p><code class="language-plaintext highlighter-rouge">git push [remote] [branch]</code> to push one of the local branches.</p>

<p><code class="language-plaintext highlighter-rouge">git pull [remote] [branch]</code> to get the <code class="language-plaintext highlighter-rouge">Remote</code> codes into your workspace.</p>

<h4 id="heading-show-information">Show Information</h4>

<p><code class="language-plaintext highlighter-rouge">git status</code> to check all the changed files</p>

<p><code class="language-plaintext highlighter-rouge">git log</code> to show the current branch's changelog</p>

<p><code class="language-plaintext highlighter-rouge">git diff</code> to show the differences between the <code class="language-plaintext highlighter-rouge">Workspace</code> and <code class="language-plaintext highlighter-rouge">Index</code></p>

<p><code class="language-plaintext highlighter-rouge">git diff HEAD</code> to show the difference between the <code class="language-plaintext highlighter-rouge">Workspace</code> and <code class="language-plaintext highlighter-rouge">Repository</code></p>

<p><code class="language-plaintext highlighter-rouge">git diff --shortstat "@{0 day ago}"</code> to show your daily coding lines number</p>

<p><code class="language-plaintext highlighter-rouge">git branch</code>: show the current branches</p>

<p><code class="language-plaintext highlighter-rouge">git remote -v</code> show the remote information</p>

<h3 id="heading-other-git-commands">Other Git Commands</h3>

<p><code class="language-plaintext highlighter-rouge">git pull origin master</code>: download the newest project from remote and merge it into the current branch.</p>

<p><code class="language-plaintext highlighter-rouge">git stash</code>: ignore the current changes and then can switch to another branch.</p>

<p><code class="language-plaintext highlighter-rouge">git checkout [branch]</code>: switch to another branch</p>

<p><code class="language-plaintext highlighter-rouge">git branch -d [branch]</code>: The <code class="language-plaintext highlighter-rouge">-d</code> option stands for <code class="language-plaintext highlighter-rouge">--delete</code>, which would delete the local branch, only if you have already pushed and merged it with your remote branches</p>

<p><code class="language-plaintext highlighter-rouge">git branch -D [branch]</code>: The <code class="language-plaintext highlighter-rouge">-D</code> option stands for <code class="language-plaintext highlighter-rouge">--delete --force</code>, which deletes the branch regardless of its push and merge status</p>

<h2 id="heading-matrix-sum-accelerator">Matrix Sum Accelerator</h2>

<p>This is the lab project in fall 2013 of UCB.</p>

<h2 id="heading-chisel3-syntax">Chisel3 Syntax</h2>

<p>We can check the syntax at <a href="https://www.chisel-lang.org/api/latest/chisel3/index.html">its official website</a>. Here lists some high efficient and frequently used syntaxes. And also I printed <a href="https://www.chisel-lang.org/doc/chisel-cheatsheet3.pdf/">Chisel3 Cheat Sheet</a> which greatly save my time.</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">Vec</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">Seq</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">Queen</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">DecoupledIO</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">PriorityEncoder</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">SyncReadMem</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">Flipped</code></p>
  </li>
</ul>

<h2 id="heading-linux-c-syntax">(Linux) C Syntax</h2>

<h3 id="heading-asm-volatile"><code class="language-plaintext highlighter-rouge">asm volatile</code></h3>

<p><code class="language-plaintext highlighter-rouge">asm volatile</code> is the inline assembly that used in language Linux C. <code class="language-plaintext highlighter-rouge">asm</code> is the keyword of <code class="language-plaintext highlighter-rouge">gcc</code> and <code class="language-plaintext highlighter-rouge">volatile</code> means <code class="language-plaintext highlighter-rouge">gcc</code> don't need to optimize the assemble codes. There is <a href="https://blog.csdn.net/slvher/article/details/8864996">a brief introduction</a> of this. And I found this term while I was trying to <a href="#Instruction test with C">test the custom extensive instructions</a> with <code class="language-plaintext highlighter-rouge">RoCC</code> interface. This syntax can run our instruction without change the compiler. Plus, it can help our C program to run several commands in order with the help of <a href="https://blog.csdn.net/KISSMonX/article/details/9105823"><code class="language-plaintext highlighter-rouge">asm volatile("" ::: "memory")</code></a>.</p>

<p>This syntax also has a feature named <a href="https://blog.csdn.net/wudiyi815/article/details/8468745">Atomic</a>. That means this command only has to states in runtime: either success or failure.</p>

<h3 id="heading-create-a-c-matrix-with-2-d-array">create a C matrix with 2-D Array</h3>

<p><a href="https://blog.csdn.net/ZYTTAE/article/details/40017401">Define and initialize the matrix</a>:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">double</span> <span class="n">matrix</span><span class="p">[</span><span class="mi">10</span><span class="p">][</span><span class="mi">15</span><span class="p">];</span>
<span class="c1">//initialize the static matrix</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">15</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="c1">// define the struct, need a pointer. m means row and n means column</span>
<span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
    <span class="kt">double</span> <span class="o">**</span><span class="n">mat</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">;</span>
<span class="p">}</span><span class="n">matrix</span><span class="p">;</span>

<span class="c1">//apply for memory space, use malloc()</span>
<span class="kt">void</span> <span class="nf">initial</span><span class="p">(</span><span class="n">matrix</span> <span class="o">&amp;</span><span class="n">T</span><span class="p">,</span><span class="kt">int</span> <span class="n">m</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">T</span><span class="p">.</span><span class="n">mat</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span> <span class="o">**</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span> <span class="o">*</span><span class="p">));</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="n">m</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">T</span><span class="p">.</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="n">T</span><span class="p">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="p">;</span>
    <span class="n">T</span><span class="p">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//initialize the matrix with the zero element.</span>
<span class="kt">void</span> <span class="nf">initValue</span><span class="p">(</span><span class="n">matrix</span> <span class="o">&amp;</span><span class="n">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">m</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
    <span class="n">initial</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">T</span><span class="p">.</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">//free the memory space</span>
<span class="kt">void</span> <span class="nf">destroy</span><span class="p">(</span><span class="n">matrix</span> <span class="o">&amp;</span><span class="n">T</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">T</span><span class="p">.</span><span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">free</span><span class="p">(</span><span class="n">T</span><span class="p">.</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">free</span><span class="p">(</span><span class="n">T</span><span class="p">.</span><span class="n">mat</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">//finished</span>

</code></pre></div></div>

<h3 id="heading-pointer-and-address-access">Pointer and address access</h3>

<p><a href="https://blog.csdn.net/synapse7/article/details/10260339">This blog</a> describes and interprets the usage of <code class="language-plaintext highlighter-rouge">*</code> and <code class="language-plaintext highlighter-rouge">&amp;</code> to get the address of one data or get the corresponding value of the address.</p>

<h2 id="heading-risc-v-spec">RISC-V SPEC</h2>

<h2 id="heading-chipyard">Chipyard</h2>

<h3 id="heading-sha3"><code class="language-plaintext highlighter-rouge">SHA3</code></h3>

<p>I mimicked <code class="language-plaintext highlighter-rouge">SHA3</code>, which also acts as one official sample to use <code class="language-plaintext highlighter-rouge">RoCC</code>. To write my accelerator, I had to study the <code class="language-plaintext highlighter-rouge">SHA3</code> project.</p>

<p>If one wants to harness <code class="language-plaintext highlighter-rouge">RoCC</code> interface to add extensive instructions, he must design his Chisel hardware project firstly and then write some C tests to prove this project works. Then modify some C files to let the compiler utilize your new instructions.</p>

<h4 id="heading-sha3-chisel"><code class="language-plaintext highlighter-rouge">SHA3</code>-Chisel</h4>

<h5 id="heading-sha3scala"><code class="language-plaintext highlighter-rouge">sha3.scala</code></h5>

<p>This is the top module of <code class="language-plaintext highlighter-rouge">SHA3</code> project.</p>

<p><img src="https://images-cdn.shimo.im/ErYI4gMr0rkyBzVu/RoCCinSHA3.png" alt="RoCCinSHA3" /></p>

<h5 id="heading-ctrlscala"><code class="language-plaintext highlighter-rouge">ctrl.scala</code></h5>

<p>This is the most complex submodule of <code class="language-plaintext highlighter-rouge">SHA3</code> project. It contains how to decode the instructions, as well as three finite-state machines. One (<code class="language-plaintext highlighter-rouge">rocc_s</code>) shows the states of the communication between the control module and the CPU(or receives instructions from CPU and uses ready-valid signals to show some states of the accelerator); One (<code class="language-plaintext highlighter-rouge">mem_s</code>) shows the states of the communication between the control module and the memory(or receives data from memory and send data back to memory and also ready-valid signals); The last one (<code class="language-plaintext highlighter-rouge">state</code>) shows the states of the communication between the control module and its submodules.</p>

<p><code class="language-plaintext highlighter-rouge">dpath.scala</code></p>

<p>This is the data path of the whole module.</p>

<p><code class="language-plaintext highlighter-rouge">dmem.scala</code></p>

<p>This is the module responsible for transform data between memory and the accelerator. So we can use this module with just a slight modifying.</p>

<p><img src="https://images-cdn.shimo.im/Mz1ZvpxNzfoxeoSc/dcache_req.png" alt="dcache_req" /></p>

<p><img src="https://images-cdn.shimo.im/cPCqqdGa1H84XK7w/dcache_resp.png" alt="dcache_resp" /></p>

<h4 id="heading-sha3-test"><code class="language-plaintext highlighter-rouge">SHA3</code>-test</h4>

<h3 id="heading-hwacha"><code class="language-plaintext highlighter-rouge">Hwacha</code></h3>

<p><code class="language-plaintext highlighter-rouge">Hwacha</code> is another more complex sample of custom extensive instructions. Plus, it also used as a component to realize the <code class="language-plaintext highlighter-rouge">RISC-V</code> Standard Vector instructions. But it's quite complex and time tiny, so I didn't learn it thoroughly last week.</p>

<h4 id="heading-hwacha-chisel"><code class="language-plaintext highlighter-rouge">Hwacha</code>-Chisel</h4>

<h2 id="heading-rocc-and-extension-instruction"><code class="language-plaintext highlighter-rouge">RoCC</code> and extension instruction</h2>

<h3 id="heading-rocc-component"><code class="language-plaintext highlighter-rouge">RoCC</code> component</h3>

<p><code class="language-plaintext highlighter-rouge">RoCC</code> interface includes two main IO, one is for processor core and the other is for cache or memory. Due to the feature of Scala, we can use <code class="language-plaintext highlighter-rouge">io.cmd</code> and <code class="language-plaintext highlighter-rouge">io.mem</code> to show this. And both IOs own several kinds of signals, such as <code class="language-plaintext highlighter-rouge">io.cmd.valid</code> <code class="language-plaintext highlighter-rouge">io.cmd.ready</code> and <code class="language-plaintext highlighter-rouge">io.cmd.bits</code>, also the <code class="language-plaintext highlighter-rouge">io.mem.req</code> and <code class="language-plaintext highlighter-rouge">io.mem.resp</code>.</p>

<p><img src="https://images-cdn.shimo.im/TG7ZkpEShygfsJDX/rocc_interface.png" alt="RoCC interface" /></p>

<p>We can see it in more details from the photo below. <strong>NOTE: this graph is a little old as it was published in 2015, and there are several slight changes.</strong></p>

<p><img src="https://images-cdn.shimo.im/ZhQo3Zs8BIQ8xrbL/RoCC2015.png" alt="RoCC 2015" /></p>

<h3 id="heading-extension-instruction-with-rocc">extension instruction with <code class="language-plaintext highlighter-rouge">RoCC</code></h3>

<p>The table below shows the <code class="language-plaintext highlighter-rouge">RoCC</code> instruction format.</p>

<p><img src="https://images-cdn.shimo.im/2f63j2FAWmENrt14/rocc_instruction_format.png" alt="RoCC instruction format" /></p>

<h4 id="heading-rocc-chisel"><code class="language-plaintext highlighter-rouge">RoCC</code>-Chisel</h4>

<p><img src="https://images-cdn.shimo.im/YhCOHPhZvhoGkkve/RoCCIO.png" alt="RoCC IO" /></p>

<h4 id="heading-instruction-test-with-c">Instruction test with C</h4>

<p><a href="https://github.com/seldridge/rocket-rocc-examples"> Tests for example Rocket Custom Coprocessors</a></p>

<h3 id="heading-hellacache"><code class="language-plaintext highlighter-rouge">HellaCache</code></h3>

<h2 id="heading-chisel-tester2">Chisel-Tester2</h2>

<p><a href="https://github.com/ucb-bar/chisel-testers2">main-page</a></p>

<h2 id="heading-hammer">Hammer</h2>

<p><a href="https://github.com/ucb-bar/hammer">main-page</a></p>

<h2 id="heading-computer-architecture">Computer Architecture</h2>

<h3 id="heading-memory-fence-and-memory-barrier">Memory Fence and Memory Barrier</h3>

<h3 id="heading-page-table-walk">Page Table Walk</h3>

<h4 id="heading-ptw-introduction">PTW Introduction</h4>

<h3 id="heading-translation-lookaside-buffer">Translation Lookaside Buffer</h3>

<h4 id="heading-tlb-introduction">TLB Introduction</h4>

<p>With the help of TLB, the CPU may access the physical address <a href="https://blog.csdn.net/leishangwen/article/details/27190959">with just one accessment</a>. And it contains both some copies of the page table and the physical address.</p>

<h4 id="heading-tlb-passthrough">TLB passthrough</h4>

<p>When I looked through the <code class="language-plaintext highlighter-rouge">TLB.scala</code> I found a valuable named <code class="language-plaintext highlighter-rouge">passthrough</code></p>

<h3 id="heading-cache-hierarchy">Cache Hierarchy</h3>

<p>I found the following information when I tried to understand the meaning of <code class="language-plaintext highlighter-rouge">memory tag</code>. I met this term while I was trying to mimic <a href="#SHA3-Chisel">the control module</a> of <code class="language-plaintext highlighter-rouge">SHA3</code>. Because it extends from <a href="#HellaCache"><code class="language-plaintext highlighter-rouge">HellaCache</code></a>, which require a tag. Although finally, I found I can give out tag casually, I learned a lot from the structure of cache including TLB.</p>

<p><img src="https://pic3.zhimg.com/80/v2-0e77de9fe46e80c179204da1bf9ad6b2_hd.jpg" alt="Cache hierarchy of the K8 core in the AMD Athlon 64 CPU" /></p>

<p>The picture above illustrates the abstract architecture of the cache hierarchy of one AMD CPU, from which we can see <a href="#TLB"><code class="language-plaintext highlighter-rouge">TLB</code></a> and Cache. Both these two components contain two levels and save instructions and data separately.</p>

<p>If we see memory hierarchy excluding TLB, then it looks like the following picture:</p>

<p><img src="http://www-x-wowotech-x-net.img.abc188.com/content/uploadfile/201905/95101556803041.png" alt="Cortex-A53 memory hierarchy" /></p>

<p>And because of the dramatically booming speeds of high-level caches, they can improve the performance of the CPU. <a href="http://www.wowotech.net/memory_management/458.html">We can regard</a> the cache is a method to improve the R/W speed of main memory, the CPU register is a method to improve that of the cache.</p>

<p><img src="http://www-x-wowotech-x-net.img.abc188.com/content/uploadfile/201905/3d2f1556803040.jpg" alt="cache speed" /></p>

<p>So how can the cache controller know whether the data we need is included in current cache? So <code class="language-plaintext highlighter-rouge">tag</code> comes.</p>

<p><img src="http://www-x-wowotech-x-net.img.abc188.com/content/uploadfile/201906/914f1559459886.png" alt="the usage of tag" /></p>

<p>We can see from the graph above, there is a tag array and its corresponding data array. Firstly, the controller will use the index to find a cache line and then compares the tag array, then bingo.</p>

<p><a href="https://zhuanlan.zhihu.com/p/31875174">Sinaean Dean</a> introduced the two usages of cache tag:</p>

<ul>
  <li>
    <p>For caches parallelly connected, using tags as a selection signal in a MUX to choose the right data.</p>
  </li>
  <li>
    <p>Know whether cache hits or misses.</p>
  </li>
</ul>

<p>If the cache miss, then it will ask a lower lever cache for the data or instructions.</p>

<p><img src="http://www-x-wowotech-x-net.img.abc188.com/content/uploadfile/201905/560d1556803043.png" alt="cooperation between different levels of caches" /></p>

<h3 id="heading-memory-read-synchronous-and-asynchronous">Memory Read (Synchronous and Asynchronous)</h3>

<p><a href="https://www.cnblogs.com/kalo1111/p/3245056.html">This blog</a> describes the <a href="#Chisel3 Syntax">synchronous memory</a> – SSRAM, which is controlled by the clock and can not read or write at the same clock cycle. But if we use asynchronous memory, then we can get the read data within one clock and if we use a combinational/asynchronous-read, sequential/synchronous-write memory, then the read-after-write hazards <a href="https://www.chisel-lang.org/api/latest/chisel3/Mem.html">are not an issue</a>.</p>

<h2 id="heading-some-trouble">Some Trouble</h2>

<h3 id="heading-psutil"><code class="language-plaintext highlighter-rouge">psutil</code></h3>

<p>ERROR INFO: <code class="language-plaintext highlighter-rouge">No module named psutil</code>.</p>

<p>But I have installed this module. Then via <a href="https://blog.csdn.net/weixin_42348333/article/details/85068701">some blogs</a>, I find that might be the version of python that excursive doesn't install the module. So I <a href="https://blog.csdn.net/u011534057/article/details/51615193">changed the default version of python</a> from 2.7 to 3.5 and reinstall it with <code class="language-plaintext highlighter-rouge">pip3</code>.</p>

<h3 id="heading-import-classes-into-intellij-idea">Import classes into <code class="language-plaintext highlighter-rouge">IntelliJ IDEA</code></h3>

<p>I use some modules of <code class="language-plaintext highlighter-rouge">chipyard</code>, which means I have to import that project into my project.</p>

<p>In the beginning, I just add the files which contain the Scala files directly, but it didn't work at all. Because the packages and classes are defined at a more high level.</p>

<p>By accidentally, I included the highest file (<code class="language-plaintext highlighter-rouge">generator</code> in this case) and it succeeds.</p>

<h3 id="heading-import-reliance-into-sbt-project">Import reliance into <code class="language-plaintext highlighter-rouge">sbt</code> project</h3>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">lazy</span> <span class="k">val</span> <span class="nv">matrixsum</span> <span class="k">=</span> <span class="nf">conditionalDependsOn</span><span class="o">(</span><span class="n">project</span> <span class="n">in</span> <span class="nf">file</span><span class="o">(</span><span class="s">"/home/singularity/chipyard/generators/matrixsum"</span><span class="o">))</span>
				<span class="o">.</span><span class="py">dependsOn</span><span class="o">(</span><span class="n">rocketchip</span><span class="o">,</span> <span class="n">chisel_testers</span><span class="o">,</span> <span class="n">sifive_blocks</span><span class="o">,</span> <span class="n">sifive_cache</span><span class="o">,</span> <span class="n">utilities</span><span class="o">,</span> <span class="n">midasTargetUtils</span><span class="o">)</span>
				<span class="o">.</span><span class="py">settings</span><span class="o">(</span><span class="n">commonSettings</span><span class="o">)</span>
</code></pre></div></div>

<p>But that's works on the top module, the <code class="language-plaintext highlighter-rouge">dependson</code> must be a subfile of the current <code class="language-plaintext highlighter-rouge">build.sbt</code>  directory.</p>

<h3 id="heading-can-not-find-the-lvy-local-lib">Can not find the lvy local lib</h3>

<p><del>Haven't solved yet</del></p>

<hr />

<p>Solved at Dec 28th by republishing it with the value of <code class="language-plaintext highlighter-rouge">version := 1.2-SNAPSHOT</code> in <code class="language-plaintext highlighter-rouge">build.sbt</code>.</p>

<pre><code class="language-pseudocode">1 targets failed
adder.compileClasspath 
Resolution failed for 1 modules:
--------------------------------------------
				edu.berkeley.cs:treadle_2.12:1.2-SNAPSHOT 
				not found: /home/singularity/.ivy2/local/edu.berkeley.cs/treadle_2.12/1.2-SNAPSHOT/ivys/ivy.xml
				not found: https://repo1.maven.org/maven2/edu/berkeley/cs/treadle_2.12/1.2-SNAPSHOT/treadle_2.12-1.2-SNAPSHOT.pom
				not found: https://oss.sonatype.org/content/repositories/releases/edu/berkeley/cs/treadle_2.12/1.2-SNAPSHOT/treadle_2.12-1.2-SNAPSHOT.pom
</code></pre>


                    </div>
                </div>
            </div>
            <footer class="unit-foot">
                <div class="unit-inner unit-foot-inner">
                    <div class="post-buttons">
                        <a class="internal gotop" href="#page" title="Back to Top">Back to Top</a>
                        
                    </div>
                    <nav class="pagination">
                        
                        
                            <a class="internal" rel="next" href="/blog/2019/12/22/2019-12-16-22-weekly-review/" title="Next Post '2019/12/16-22 weekly review'">2019/12/16-22 weekly review → </a>
                        
                    </nav>
                </div>
            </footer>
            <div class="misc-content">
                
                
                    <div id="container"></div>
                    <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
                    <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
                    <script>
                    var gitment = new Gitment({
                      owner: "singularitykchen",
                      repo: "https://github.com/SingularityKChen/singularitykchen.github.io",
                      oauth: {
                        client_id: "d22349012c96f951207c",
                        client_secret: "843195c3b1f0b2f258f88684767445c2ceae1996",
                      },
                      labels: "2019/12/09-15 weekly review",
                    })
                    gitment.render('container')
                    </script>
                
            </div>
        </div>
    </div>
</article>

                    </div>
                </div>
            </div>
        </div>
        <footer class="the-footer">
    <div class="unit-foot">
        <div class="unit-inner unit-foot-inner">
            <div class="misc vcard">
                <div class="about">
                    <h4><a href="/">About</a></h4>
                    
                        <p>A gem-based responsive simple texture styled <a href="http://jekyllrb.com/">Jekyll</a> theme.</p>
                    
                    <p><small>Theme <a href="https://github.com/yizeng/jekyll-theme-simple-texture" target="_blank">Simple Texture</a> developed by <a href="https://yizeng.me" target="_blank">Yi Zeng</a>, powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>.</small></p>
                </div>
                <div class="social-links">
                    
                        <a class="ico-gmail" href="mailto:chency_singularity@163.com" rel="me" target="_blank" title="email"></a>
                    
                    <a class="ico-rss" href="/feed.xml" rel="me" target="_blank" title="feed"></a>
                    
                        
                            <a class="ico-github" href="https://github.com/SingularityKChen" rel="me" target="_blank" title="github"></a>
                        
                    
                        
                            <a class="ico-linkedin" href="https://www.linkedin.com/in/singularitykchen/" rel="me" target="_blank" title="linkedin"></a>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                </div>
            </div>
        </div>
    </div>
    <a href="#" class="internal back-to-top">Back to Top</a>
</footer>

    </div>

    <script>
$(document).ready(function () {
    var offset = 50,
        duration = 500,
        width = 960;
    $(window).scroll(function () {
        if ($(window).width() > width) {
            if ($(this).scrollTop() > offset) {
                $('footer').css('top', '20px');
                $('footer .back-to-top').fadeIn(duration);
            } else {
                $('footer').css('top', 'auto');
                $('footer .back-to-top').fadeOut(duration);
            }
        }
    });
    $(window).resize(function () {
        if ($(window).width() < width) {
            $('footer').css('top', 'auto');
            $('footer .back-to-top').fadeOut(duration);
        }
        if ($(window).width() >= width && $(this).scrollTop() > offset) {
            $('footer').css('top', '20px');
            $('footer .back-to-top').fadeIn(duration);
        }
    });

    $('footer .back-to-top, .gotop').on('click', function (event) {
        event.preventDefault();
        $('html, body').animate({
            scrollTop: 0
        }, duration);
        return false;
    });

    $('.show-hidden').on('click', function () {
        $(this).parent().next().toggleClass("hidden");
        $(this).toggleClass("hidden");
    });
});
</script>

<!-- Show menu overlay + Jekyll Simple Search option -->
<script src="/assets/javascripts/jekyll-search.jquery.js"></script>
<script>
$(document).ready(function () {
    $('.search-field').simpleJekyllSearch({
      jsonFile: '/search.json',
      template: '<li><a href="{url}">{title} <span class="entry-date"><time datetime="{date}">{shortdate}</time></span></a></li>',
      searchResults: '.search-wrapper .results',
      searchResultsTitle: '<h4>Search results</h4>',
      noResults: '<p>Oh shucks<br/><small>Nothing found :(</small></p>'
    });
});

(function ($, window, undefined) {
    var closeOverlay = function () {
        $('.nav-wrapper, .search-wrapper').removeAttr('style');
        $(".nav-form, .search-form").removeClass('active');
        $("body").removeClass('nav-overlay search-overlay');
    };

    $('.nav-global .btn-search').on('click', function () {
        $('.search-wrapper').css({display: "block"});
        $(".search-form").addClass('active');
        $(".search-form").find('input').focus();
        $("body").addClass('search-overlay');
    });

    $('.nav-global .btn-menu').on('click', function () {
        $('.nav-wrapper').css({display: "block"});
        $(".nav-form").addClass('active');
        $(".nav-form .search-field").prop('disabled', true);
        $("body").addClass('nav-overlay');
    });

    $('.nav-wrapper .btn-close, .search-wrapper .btn-close').on('click', function () {
        closeOverlay();
    });

    $(document).on('keyup', function (e) {
        if (e.keyCode === 27) {
            closeOverlay();
        }
    });
})(jQuery, window);
</script>

<script src='//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.js'></script>
<script src='//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-buttons.min.js'></script>
<script src="/assets/javascripts/unveil/jquery.unveil.min.js"></script>

<script>
    window.jQuery.fancybox || document.write('<script src="/assets/javascripts/fancybox/jquery.fancybox.pack.js?v=2.1.4"><\/script>')
    window.jQuery.fancybox.helpers.buttons || document.write('<script src="/assets/javascripts/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"><\/script>')
</script>

<script>
    $("head").append('<link rel="stylesheet" href="/assets/javascripts/fancybox/jquery.fancybox.css?v=2.1.4" type="text/css" />');
    $("head").append('<link rel="stylesheet" href="/assets/javascripts/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" />');
    $(".post-image").fancybox({
        prevEffect: 'none',
        nextEffect: 'none',
        closeBtn: true,
        helpers: {
            title: {
                type: 'float'
            }
        }
    });
    $(document).ready(function () {
        $(".post-image > img").unveil(450);
    });
</script>

</body>

</html>